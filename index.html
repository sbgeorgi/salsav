<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SALSA Agrivoltaics – University of Arizona</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&family=Source+Sans+3:wght@400;600&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Core Stylesheet -->
    <link rel="stylesheet" href="css/main-styles.css">
</head>

<body>
    <nav class="navbar" id="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <img src="static/salsa-logo.png" alt="SALSA Agrivoltaics Logo">
                <span>AGRIVOLTAICS</span>
            </a>
            <div class="navbar-links" id="navbar-links">
                <ul class="navbar-menu">
                    <li><a href="index.html" class="navbar-link active">Home</a></li>
                    <li class="has-dropdown">
                        <a href="#" class="navbar-link">Research</a>
                        <ul class="dropdown-content">
                            <li><a href="research-ecophysiology.html">Ecophysiology</a></li>
                            <li><a href="research-scaling-up.html">Scaling Up</a></li>
                            <li><a href="research-scaling-out.html">Scaling Out</a></li>
                        </ul>
                    </li>
                    <li><a href="education.html" class="navbar-link">Education</a></li>
                    <li><a href="sites.html" class="navbar-link">Sites</a></li>
                    <li><a href="news.html" class="navbar-link">News</a></li>
                    <li><a href="team.html" class="navbar-link">Team</a></li>
                    <li><a href="#footer" class="navbar-link">Contact</a></li>
                </ul>
            </div>
            <button type="button" class="mobile-toggle" id="mobile-toggle" aria-label="Toggle menu" aria-expanded="false">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
    </nav>

    <main>
        <!-- HERO -->
        <section class="hero">
            <div class="container">
                <h1 class="hero-headline reveal">Harvesting the Sun, Twice.</h1>
                <div class="hero-subheadline reveal" style="transition-delay: 0.2s;">
                    <span>SALSA helps you</span>
                    <div class="typing-container">
                        <span id="typing-text"></span><span class="typing-cursor"></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ORB -->
        <section class="orb-section">
            <div class="orb-container" id="orb-container">
                <div class="orb-video-wrapper">
                    <video id="orb-video" class="orb-video" src="static/UA_Agrivoltaics_1.mp4" autoplay loop muted
                        playsinline></video>
                </div>
                <button class="mute-btn" id="muteBtn" aria-label="Toggle Mute">
                    <i class="fa-solid fa-volume-xmark"></i>
                </button>
            </div>
        </section>

        <!-- PARTNERS SECTION -->
        <section class="partners-section" id="partners-section">
            <div class="container">
                <div class="news-header reveal">
                    <h2>We Are Proud to be Partners</h2>
                </div>
                <p class="subtitle reveal" style="text-align: center; max-width: 800px; margin: -2rem auto 3rem;">
                    Complex challenges require great partners with diverse backgrounds. Our team bridges the biophysical and social sciences, and works across food, water, and energy disciplines.
                </p>
                <div class="partners-grid reveal" style="transition-delay: 0.2s;">
                     <a href="https://sgde.arizona.edu/" target="_blank" rel="noopener" class="partner-logo-link">
                        <img src="static/uaes.png" alt="UArizona School of Geography, Development & Environment Logo" class="partner-logo">
                    </a>
                    <a href="https://agnr.umd.edu/" target="_blank" rel="noopener" class="partner-logo-link">
                        <img src="static/umav.png" alt="University of Maryland College of Agriculture & Natural Resources Logo" class="partner-logo">
                    </a>
                    <a href="https://environmentalscience.arizona.edu/" target="_blank" rel="noopener" class="partner-logo-link">
                        <img src="static/uaenv.png" alt="UArizona Environmental Science Logo" class="partner-logo">
                    </a>
                    <a href="https://www.aes.com/" target="_blank" rel="noopener" class="partner-logo-link">
                        <img src="static/aes.png" alt="AES Corporation Logo" class="partner-logo">
                    </a>
                    <a href="https://www.nrel.gov/" target="_blank" rel="noopener" class="partner-logo-link">
                        <img src="static/nrel.png" alt="NREL Transforming Energy Logo" class="partner-logo">
                    </a>
                    <a href="https://www.energy.gov/eere/solar/solar-energy-technologies-office" target="_blank" rel="noopener" class="partner-logo-link">
                        <img src="static/doe.jpg" alt="U.S. Department of Energy Solar Awardee Logo" class="partner-logo">
                    </a>
                </div>
            </div>
        </section>

        <!-- RESEARCH PILLARS -->
        <section class="section section-dark pillars-section">
            <div class="container">
                <div class="pillars-left">
                    <div class="pillar-item" data-image="static/ecophysiology-hero.jpg">
                        <span class="tag">01. Ecophysiology</span>
                        <h3>The Plant-Panel Symbiosis</h3>
                        <p>We study the intricate interactions between solar panels and plant life, measuring how shade and altered microclimates affect crop health, water use, and overall yield.</p>
                    </div>
                    <div class="pillar-item" data-image="static/scaling-up-hero.jpg">
                        <span class="tag">02. Scaling Up</span>
                        <h3>From Kilowatts to Megawatts</h3>
                        <p>Taking proven benefits from test plots to utility-scale requires robust engineering and economic models to create a clear roadmap for profitable projects.</p>
                    </div>
                    <div class="pillar-item" data-image="static/scaling-out-card.png">
                        <span class="tag">03. Scaling Out</span>
                        <h3>Adapting to Diverse Environments</h3>
                        <p>An agrivoltaic solution for Arizona's desert differs from one for Colorado's pastures. Our research spans multiple climates to develop adaptable models that work worldwide.</p>
                    </div>
                </div>
                <div class="pillars-right">
                    <div class="pillar-image is-visible" id="pillar-image-ecophysiology-hero"><img src="static/ecophysiology-hero.jpg" alt="Ecophysiology research"></div>
                    <div class="pillar-image" id="pillar-image-scaling-up-hero"><img src="static/scaling-up-hero.jpg" alt="Large-scale agrivoltaics"></div>
                    <div class="pillar-image" id="pillar-image-scaling-out-card"><img src="static/scaling-out-card.png" alt="Agrivoltaics in diverse environments"></div>
                </div>
            </div>
        </section>

        <!-- RESEARCHER SECTION -->
        <section class="section researcher-section">
            <div class="container">
                <div class="researcher-info reveal">
                    <span class="tag">The SALSA Team</span>
                    <h2>A climate expert takes you inside the research</h2>
                    <h3>Dr. Greg Barron-Gafford, Lead Investigator</h3>
                    <p>As a Professor at the University of Arizona, Dr. Barron-Gafford leads our multi-disciplinary team exploring the food-energy-water nexus, demonstrating how agrivoltaics can meet our growing need for renewable energy and sustainable agriculture.</p>
                </div>
                <div class="researcher-video-wrapper reveal" style="transition-delay: 0.2s;">
                    <video class="researcher-video" src="static/farm_to_table.mp4" controls poster="static/barron-gafford-poster.jpg"></video>
                </div>
            </div>
        </section>
        
        <!-- FEATURED SITES CAROUSEL -->
        <section class="section sites-carousel-section">
            <div class="container">
                <div class="news-header reveal">
                    <h2>Our Global Research Sites</h2>
                    <a href="sites.html" class="cta-button" style="padding:.8rem 2rem;">View All Sites</a>
                </div>
                <p class="subtitle reveal" style="text-align: center; max-width: 800px; margin: -2rem auto 3rem;">
                    From arid deserts to community gardens, our research spans diverse climates to create adaptable, resilient agrivoltaic models.
                </p>
            </div>
            
            <div class="carousel-container reveal" style="transition-delay: 0.2s;">
                <div class="carousel-track" id="sites-carousel-track">
                    <!-- Cards will be dynamically inserted here by JS -->
                </div>
            </div>
            <div class="carousel-nav reveal" style="transition-delay: 0.2s;">
                <button class="nav-btn" id="sites-prevBtn" aria-label="Previous slide"><i class="fa-solid fa-arrow-left"></i></button>
                <button class="nav-btn" id="sites-nextBtn" aria-label="Next slide"><i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </section>

        <!-- CTA -->
        <section class="cta-section">
            <div class="container">
                <h2 class="reveal">Let’s shape the future of energy & agriculture.</h2>
                <p class="reveal" style="transition-delay: 0.1s;">Our research provides data-driven models that developers, farmers and policymakers can trust.</p>
                <a href="#footer" class="cta-button reveal" style="transition-delay: 0.2s;">Talk to an Expert</a>
            </div>
        </section>
    </main>

    <footer class="footer" id="footer">
        <div class="container footer-content">
            <div class="footer-brand">
                <h3>SALSA Agrivoltaics</h3>
                <p>A project of the University of Arizona, pioneering food-energy-water solutions.</p>
            </div>
            <div class="footer-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="sites.html">Sites</a></li>
                    <li><a href="news.html">News</a></li>
                    <li><a href="team.html">Team</a></li>
                </ul>
            </div>
            <div class="footer-contact">
                <h4>Contact Us</h4>
                <p>University of Arizona</p>
                <p><a href="mailto:gregbg@arizona.edu">gregbg@arizona.edu</a></p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2024 SALSA Agrivoltaics. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- General Initializers ---
            const initScrollReveal = () => {
                const revealObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));
            };

            const initStickyNav = () => {
                const navbar = document.getElementById('navbar');
                if (!navbar) return;
                window.addEventListener('scroll', () => {
                    navbar.classList.toggle('scrolled', window.scrollY > 50);
                });
            };
            
            const initMobileNav = () => {
                const toggleBtn = document.getElementById('mobile-toggle');
                const navLinks = document.getElementById('navbar-links');
                const icon = toggleBtn.querySelector('i');
                if (!toggleBtn || !navLinks) return;
                toggleBtn.addEventListener('click', () => {
                    navLinks.classList.toggle('active');
                    const isActive = navLinks.classList.contains('active');
                    toggleBtn.setAttribute('aria-expanded', isActive);
                    icon.className = isActive ? 'fa-solid fa-xmark' : 'fa-solid fa-bars';
                });
            };

            // --- Homepage-Specific Modules ---
            const initTypingAnimation = () => {
                const typingText = document.getElementById('typing-text');
                if (!typingText) return;
                const words = ["optimize land use.", "conserve water resources.", "enhance crop yields.", "create new revenue streams."];
                let wordIndex = 0, letterIndex = 0, isDeleting = false;
                const type = () => {
                    const currentWord = words[wordIndex];
                    let speed = isDeleting ? 75 : 150;
                    if (isDeleting) {
                        typingText.textContent = currentWord.substring(0, letterIndex - 1);
                        letterIndex--;
                        if (letterIndex === 0) { isDeleting = false; wordIndex = (wordIndex + 1) % words.length; }
                    } else {
                        typingText.textContent = currentWord.substring(0, letterIndex + 1);
                        letterIndex++;
                        if (letterIndex === currentWord.length) { isDeleting = true; speed = 2000; }
                    }
                    setTimeout(type, speed);
                };
                type();
            };

            const initOrbScale = () => {
                const orb = document.getElementById('orb-container');
                if (!orb) return;
                window.addEventListener('scroll', () => {
                    const scale = Math.min(1.5, 1 + window.scrollY / 1000);
                    orb.style.transform = `scale(${scale})`;
                }, { passive: true });
            };

            const initOrbVideo = () => {
                const orbVideo = document.getElementById('orb-video');
                const muteBtn = document.getElementById('muteBtn');
                if (!orbVideo || !muteBtn) return;
                const icon = muteBtn.querySelector('i');
                const setIcon = () => { icon.className = orbVideo.muted ? 'fa-solid fa-volume-xmark' : 'fa-solid fa-volume-high'; };
                orbVideo.play().catch(() => { orbVideo.muted = true; setIcon(); });
                muteBtn.addEventListener('click', (e) => { e.stopPropagation(); orbVideo.muted = !orbVideo.muted; setIcon(); });
                setIcon();
            };
            
            const initPillars = () => {
                const pillarItems = document.querySelectorAll('.pillar-item');
                const pillarImages = document.querySelectorAll('.pillar-image');
                if (pillarItems.length === 0) return;
                const observer = new IntersectionObserver(entries => {
                    entries.forEach(entry => {
                        const imgId = `pillar-image-${entry.target.dataset.image.split('/')[1].split('.')[0]}`;
                        const img = document.getElementById(imgId);
                        entry.target.classList.toggle('is-visible', entry.isIntersecting);
                        if (entry.isIntersecting && img) {
                            pillarImages.forEach(i => i.classList.remove('is-visible'));
                            img.classList.add('is-visible');
                        }
                    });
                }, { rootMargin: '-40% 0px -40% 0px' });
                pillarItems.forEach(item => observer.observe(item));
            };
            
            // --- Reusable Carousel Module ---
            const createCarousel = (trackId, nextBtnId, prevBtnId) => {
                const track = document.getElementById(trackId);
                if (!track) return;

                const nextBtn = document.getElementById(nextBtnId);
                const prevBtn = document.getElementById(prevBtnId);
                let currentIndex = 0;
                let slides = Array.from(track.children);
                if (slides.length === 0) return;
                
                let slideWidth = slides[0].getBoundingClientRect().width;
                const totalVisibleSlides = Math.round(track.parentElement.clientWidth / slideWidth);
                const totalSlides = slides.length / 2;

                const moveToSlide = () => {
                    track.style.transform = `translateX(-${slideWidth * currentIndex}px)`;
                };

                const handleNext = () => {
                    currentIndex++;
                    track.style.transition = 'transform .5s ease-in-out';
                    moveToSlide();

                    if (currentIndex >= totalSlides) {
                        setTimeout(() => {
                            track.style.transition = 'none';
                            currentIndex = 0;
                            moveToSlide();
                        }, 500);
                    }
                };

                nextBtn.addEventListener('click', handleNext);
                prevBtn.addEventListener('click', () => {
                     if (currentIndex === 0) {
                        track.style.transition = 'none';
                        currentIndex = totalSlides;
                        moveToSlide();
                        setTimeout(() => {
                            track.style.transition = 'transform .5s ease-in-out';
                            currentIndex--;
                            moveToSlide();
                        }, 20);
                    } else {
                        currentIndex--;
                        moveToSlide();
                    }
                });

                setInterval(handleNext, 5000);

                window.addEventListener('resize', () => {
                    slideWidth = slides[0].getBoundingClientRect().width;
                    moveToSlide();
                });
            };

            const SITES_DATA = [
                { href: 'sites.html#arizona-sites-detailed', imgSrc: 'static/biosphere2agriv.jpg', alt: 'Agrivoltaics at Biosphere 2', tag: 'Arizona, USA', title: 'Biosphere 2 Laboratory', desc: "The pioneering site where agrivoltaics in drylands was born, proving a 'win-win-win' for food, water, and energy." },
                { href: 'sites.html#colorado-site-detailed', imgSrc: 'static/jacksagriv.jpg', alt: 'Agrivoltaics at Jack\'s Solar Garden', tag: 'Colorado, USA', title: 'Jack’s Solar Garden', desc: 'A nationally-recognized showcase focusing on microclimate benefits and improving pasture quality for livestock grazing.' },
                { href: 'sites.html#kenya-site-detailed', imgSrc: 'static/kenyaagriv.jpg', alt: 'Community agrivoltaics in Kenya', tag: 'Makueni County, Kenya', title: 'Community Agrivoltaics', desc: 'A community-focused site providing clean energy and irrigation to tackle food and energy security in a semi-arid region.' },
                { href: 'sites.html#israel-site-detailed', imgSrc: 'static/aravaagriv.jpg', alt: 'Agrivoltaics in the Arava Desert, Israel', tag: 'Arava Desert, Israel', title: 'Extreme Climate Research', desc: 'Developing robust systems for extreme desert climates, focusing on enhancing crop yields while drastically reducing water needs.' },
                { href: 'sites.html#morocco-collaboration-detailed', imgSrc: 'static/um6pagriv.jpeg', alt: 'Green Energy Park in Morocco', tag: 'Ben Guerir, Morocco', title: 'Green Energy Park', desc: 'A regional hub for West Africa, focusing on water-saving tech, battery storage, and increasing solar output via crop cooling.' },
                { href: 'sites.html#mexico-collaboration-detailed', imgSrc: 'static/paseagriv.jpg', alt: 'PASE Agrivoltaics project in Mexico', tag: 'Mexico City, Mexico', title: 'PASE Project at UNAM', desc: 'Mexico’s first full agrivoltaics pilot, established at UNAM as a flagship sustainable and educational research plot.' }
            ];

            const populateSitesCarousel = () => {
                const track = document.getElementById('sites-carousel-track');
                if(!track) return;
                
                const createCardHTML = (site) => `
                    <div class="slide">
                        <a class="news-card" href="${site.href}" target="_blank">
                            <div class="news-image-wrapper"><img src="${site.imgSrc}" alt="${site.alt}"></div>
                            <div class="news-card-content">
                                <span class="tag">${site.tag}</span>
                                <h3>${site.title}</h3>
                                <p>${site.desc}</p>
                            </div>
                        </a>
                    </div>
                `;
                
                const allSitesHTML = [...SITES_DATA, ...SITES_DATA].map(createCardHTML).join('');
                track.innerHTML = allSitesHTML;
            };

            // Initialize Everything
            initScrollReveal();
            initStickyNav();
            initMobileNav();
            initTypingAnimation();
            initOrbScale();
            initOrbVideo();
            initPillars();
            populateSitesCarousel();
            createCarousel('sites-carousel-track', 'sites-nextBtn', 'sites-prevBtn');
        });
    </script>
</body>
</html>